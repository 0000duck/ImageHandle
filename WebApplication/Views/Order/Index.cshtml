@model  IEnumerable<Models.Order>
@using WebApplication.Common;
@using Models;
@{ 
    ViewBag.Title = "Orders";
}
<script type="text/javascript">
    function ChangeStatus(orderid,status) {
        if (confirm("确定吗？")) {
            url = "/Order/Update";
            parameter = { id: orderid, status: status };
            $.post(url, parameter, function (data) {
                window.location = "/Order/Index";
            });
        }
    }
</script>
<div class="page-header">
    <h1>订单列表</h1>
    <a href="@Url.Action("Add","Order")" class="btn btn-sm btn-primary">创建表单</a>
</div>
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-body">
                <table class="table table-hover"> 
                        @foreach (var item in @Model)
                        {
                            <tr>
                                <td width="120px">
                                    <img src="@item.ImageUrl" width="96" height="96"/></td>
                                <td align="left">
                                    淘宝订单号：@item.TaobaoId<br />
                                    时间：@item.SubmitTime<br />
                                    印章类型：@item.Sample.ImageType.ToString()
                                    字体样式： @item.Sample.Style.ToString()&nbsp;&nbsp; <a href="@item.ImageUrl" target="_blank">下载PNG图片</a>
                                </td>
                                <td style="width: 200px">
                                    @if (item.Status == (int)EnumStatus.待审批)
                                    {
                                        <a href="#" onClick="ChangeStatus(@item.Id,@Convert.ToInt32(EnumStatus.待生产)); return false;" class="btn btn-sm btn-primary">同意</a>
                                        <a href="#" onClick="ChangeStatus(@item.Id,@Convert.ToInt32(EnumStatus.已删除)); return false;" class="btn btn-sm btn-primary">不同意</a>
                                    }
                                    else if (item.Status == (int)EnumStatus.待生产)
                                    {
                                        <a href="#" onClick="ChangeStatus(@item.Id,@Convert.ToInt32(EnumStatus.生产中)); return false;" class="btn btn-sm btn-primary">生产</a>
                                        <br />
                                        <span>审核人：@item.AuditorName</span>
                                    }
                                    else if (item.Status == (int)EnumStatus.生产中)
                                    {
                                        <a href="#" onClick="ChangeStatus(@item.Id,@Convert.ToInt32(EnumStatus.已完成)); return false;" class="btn btn-sm btn-primary">完成</a>
                                        <br />
                                        <span>审核人：@item.AuditorName</span>
                                        <br />
                                        <span>生产员：@item.ProductorName</span>
                                    }
                                    else if (item.Status == (int)EnumStatus.已完成)
                                    { 
                                        <a href="#" onClick="ChangeStatus(@item.Id,@Convert.ToInt32(EnumStatus.已删除)); return false;" class="btn btn-sm btn-primary">删除</a>
                                        <br />
                                        <span>已完成</span>
                                        <br />
                                        <span>审核人：@item.AuditorName</span>
                                        <br />
                                        <span>生产员：@item.ProductorName</span>
                                    }
                                    else if (item.Status == (int)EnumStatus.已删除)
                                    { 
                                        <span>已删除</span>
                                        <br />
                                        <span>删除时间：@item.DeleteTime</span>
                                    }
                                </td>
                            </tr>
                        } 
                </table>
            </div>
        </div>
    </div>
</div>

